[2018-07-11 11:57:23,593 INFO] Start training...
[2018-07-11 11:57:23,593 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, vector_type='glove.6B.100d')
[2018-07-11 11:57:36,856 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-11 11:58:35,398 INFO] | epoch   1 | train_loss  5.36 | val_ppl   162.03 | time  53.9s
[2018-07-11 11:59:29,589 INFO] | epoch   2 | train_loss  4.91 | val_ppl   141.38 | time  54.2s
[2018-07-11 12:00:23,862 INFO] | epoch   3 | train_loss  4.76 | val_ppl   135.60 | time  54.3s
[2018-07-11 12:01:17,954 INFO] | epoch   4 | train_loss  4.67 | val_ppl   132.10 | time  54.1s
[2018-07-11 12:01:17,954 INFO] start to save model on nnlm.model
[2018-07-11 12:01:20,663 INFO] test_ppl: 121.5
[2018-07-11 12:01:52,326 INFO] Start training...
[2018-07-11 12:01:52,326 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, vector_type='glove.6B.100d')
[2018-07-11 12:02:04,668 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-11 12:03:03,107 INFO] | epoch   1 | train_loss  5.36 | val_ppl   162.03 | time  54.1s
[2018-07-11 12:03:57,274 INFO] | epoch   2 | train_loss  4.91 | val_ppl   141.38 | time  54.2s
[2018-07-11 12:04:51,551 INFO] | epoch   3 | train_loss  4.76 | val_ppl   135.60 | time  54.3s
[2018-07-11 12:05:45,834 INFO] | epoch   4 | train_loss  4.67 | val_ppl   132.10 | time  54.3s
[2018-07-11 12:05:45,835 INFO] start to save model on nnlm.model
[2018-07-11 12:05:48,531 INFO] test_ppl: 121.5
[2018-07-11 12:13:51,900 INFO] Start training...
[2018-07-11 12:13:51,901 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-11 12:14:03,920 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-11 12:14:30,772 INFO] Start training...
[2018-07-11 12:14:30,773 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-11 12:14:44,150 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-11 12:15:15,018 INFO] Start training...
[2018-07-11 12:15:15,018 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-11 12:15:28,133 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-11 12:16:25,528 INFO] | epoch   1 | train_loss  5.97 | val_ppl   227.08 | time  52.2s
[2018-07-11 12:17:17,273 INFO] | epoch   2 | train_loss  5.30 | val_ppl   198.76 | time  51.7s
[2018-07-11 12:18:08,877 INFO] | epoch   3 | train_loss  5.18 | val_ppl   185.42 | time  51.6s
[2018-07-11 12:19:00,652 INFO] | epoch   4 | train_loss  5.10 | val_ppl   175.43 | time  51.8s
[2018-07-11 12:19:00,652 INFO] start to save model on nnlm.model
[2018-07-11 12:19:03,120 INFO] test_ppl: 161.4
[2018-07-11 17:06:41,967 INFO] Start training...
[2018-07-11 17:06:41,968 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=4, every_n_epoch_save=4, input_embeddings_trainable=True, log_file='log', lr=1.0, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-11 17:06:54,421 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-16 18:08:17,015 INFO] Start training...
[2018-07-16 18:08:17,015 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=8, input_embeddings_trainable=1, log_file='log', lr=0.5, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-16 18:08:29,051 INFO] train token: 2127402
[2018-07-16 18:08:29,051 INFO] test token: 250140
[2018-07-16 18:08:29,051 INFO] valid token: 221606
[2018-07-16 18:08:29,457 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-16 18:09:00,315 INFO] | epoch   1 | train_loss -0.32 | val_loss    -0.35 | time  26.4s
[2018-07-16 18:09:28,651 INFO] | epoch   2 | train_loss -0.35 | val_loss    -0.37 | time  28.3s
[2018-07-16 18:09:58,235 INFO] | epoch   3 | train_loss -0.37 | val_loss    -0.38 | time  29.6s
[2018-07-16 18:10:26,995 INFO] | epoch   4 | train_loss -0.39 | val_loss    -0.39 | time  28.8s
[2018-07-16 18:10:57,192 INFO] | epoch   5 | train_loss -0.39 | val_loss    -0.40 | time  30.2s
[2018-07-16 18:11:19,866 INFO] | epoch   6 | train_loss -0.40 | val_loss    -0.40 | time  22.7s
[2018-07-16 18:11:48,228 INFO] | epoch   7 | train_loss -0.40 | val_loss    -0.41 | time  28.4s
[2018-07-16 18:12:19,429 INFO] | epoch   8 | train_loss -0.41 | val_loss    -0.41 | time  31.2s
[2018-07-16 18:12:19,430 INFO] start to save model on nnlm.model
[2018-07-16 18:12:20,747 INFO] test_loss:  -0.4
[2018-07-16 22:55:08,682 INFO] Start training...
[2018-07-16 22:55:08,682 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=100, input_embeddings_trainable=1, log_file='log', lr=0.5, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=True, vector_type='glove.6B.100d')
[2018-07-16 22:55:21,769 INFO] train token: 2127402
[2018-07-16 22:55:21,769 INFO] test token: 250140
[2018-07-16 22:55:21,769 INFO] valid token: 221606
[2018-07-16 22:55:22,795 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-07-16 22:56:02,618 INFO] | epoch   1 | train_loss -0.32 | val_loss    -0.10 | time  30.3s
[2018-07-16 22:56:33,276 INFO] | epoch   2 | train_loss -0.35 | val_loss    -0.10 | time  30.7s
[2018-07-16 22:57:02,845 INFO] | epoch   3 | train_loss -0.37 | val_loss    -0.10 | time  29.6s
[2018-07-16 22:57:31,249 INFO] | epoch   4 | train_loss -0.39 | val_loss    -0.10 | time  28.4s
[2018-07-16 22:58:00,295 INFO] | epoch   5 | train_loss -0.39 | val_loss    -0.10 | time  29.0s
[2018-07-16 22:58:30,522 INFO] | epoch   6 | train_loss -0.40 | val_loss    -0.10 | time  30.2s
[2018-07-16 22:58:58,655 INFO] | epoch   7 | train_loss -0.40 | val_loss    -0.10 | time  28.1s
[2018-07-16 22:59:27,848 INFO] | epoch   8 | train_loss -0.41 | val_loss    -0.10 | time  29.2s
[2018-07-16 22:59:28,595 INFO] test_loss:  -0.1

(explanation: by accident, i train on a full softmax and normalized hidden output. out emb is
fixed. the loss function is max cosine over all normalized dot product. and the evaluation of val,
test data is also this. So this result is meaningless)
[2018-08-08 13:30:31,391 INFO] Start training...
[2018-08-08 13:30:31,392 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=40, log_file='log', lr=0.5, not_update_input_emb=False, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=False, vector_type='glove.6B.100d')
[2018-08-08 13:30:42,397 INFO] train token: 2127402
[2018-08-08 13:30:42,397 INFO] test token: 250140
[2018-08-08 13:30:42,397 INFO] valid token: 221606
[2018-08-08 13:30:42,604 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-08 13:31:16,147 INFO] | epoch   1 | train_loss -0.69 | val_loss -0.74965 | time  30.2s
[2018-08-08 13:31:46,604 INFO] | epoch   2 | train_loss -0.78 | val_loss -0.80670 | time  30.5s
[2018-08-08 13:32:16,909 INFO] | epoch   3 | train_loss -0.82 | val_loss -0.83637 | time  30.3s
[2018-08-08 13:32:46,776 INFO] | epoch   4 | train_loss -0.85 | val_loss -0.85535 | time  29.9s
[2018-08-08 13:33:17,343 INFO] | epoch   5 | train_loss -0.86 | val_loss -0.86896 | time  30.6s
[2018-08-08 13:33:47,720 INFO] | epoch   6 | train_loss -0.87 | val_loss -0.87943 | time  30.4s
[2018-08-08 13:34:17,742 INFO] | epoch   7 | train_loss -0.88 | val_loss -0.88785 | time  30.0s
[2018-08-08 13:34:47,747 INFO] | epoch   8 | train_loss -0.89 | val_loss -0.89483 | time  30.0s
[2018-08-08 13:34:48,771 INFO] test_loss: -0.89483

(explanation: this is normal one. using cbow wiki vec, fix out, up input emb. the cosine per word
value as loss function)
[2018-08-08 13:54:07,189 INFO] Start training...
[2018-08-08 13:54:07,189 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=40, log_file='log', lr=0.5, not_update_input_emb=False, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=False, vector_type='glove.6B.100d')
[2018-08-08 13:54:18,467 INFO] train token: 2127402
[2018-08-08 13:54:18,468 INFO] test token: 250140
[2018-08-08 13:54:18,468 INFO] valid token: 221606
[2018-08-08 13:54:18,610 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-08 13:54:42,541 INFO] | epoch   1 | train_loss -0.55 | val_loss -0.61685 | time  20.7s
[2018-08-08 13:55:03,918 INFO] | epoch   2 | train_loss -0.64 | val_loss -0.66675 | time  21.4s
[2018-08-08 13:55:24,967 INFO] | epoch   3 | train_loss -0.68 | val_loss -0.69771 | time  21.0s
[2018-08-08 13:55:46,425 INFO] | epoch   4 | train_loss -0.70 | val_loss -0.72057 | time  21.5s
[2018-08-08 13:56:07,374 INFO] | epoch   5 | train_loss -0.72 | val_loss -0.73892 | time  20.9s
[2018-08-08 13:56:27,699 INFO] | epoch   6 | train_loss -0.74 | val_loss -0.75412 | time  20.3s
[2018-08-08 13:56:47,704 INFO] | epoch   7 | train_loss -0.76 | val_loss -0.76718 | time  20.0s
[2018-08-08 13:57:07,040 INFO] | epoch   8 | train_loss -0.77 | val_loss -0.77862 | time  19.3s
[2018-08-08 13:57:07,832 INFO] test_loss: -0.77698
[2018-08-08 13:57:08,882 INFO] test_ppl: 19504.33207

(explanation: the corespondding PPL of val_loss of the last experiment)
[2018-08-08 14:00:03,953 INFO] Start training...
[2018-08-08 14:00:03,953 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=40, log_file='log', lr=0.5, not_update_input_emb=False, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=False, vector_type='glove.6B.100d')
[2018-08-08 14:00:14,853 INFO] train token: 2127402
[2018-08-08 14:00:14,853 INFO] test token: 250140
[2018-08-08 14:00:14,853 INFO] valid token: 221606
[2018-08-08 14:00:14,991 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-08 14:00:37,608 INFO] | epoch   1 | train_loss -0.55 | val_loss 20904.45924 | time  19.5s
[2018-08-08 14:00:58,008 INFO] | epoch   2 | train_loss -0.64 | val_loss 20230.36030 | time  20.4s
[2018-08-08 14:01:18,796 INFO] | epoch   3 | train_loss -0.68 | val_loss 19921.62253 | time  20.8s
[2018-08-08 14:01:39,372 INFO] | epoch   4 | train_loss -0.70 | val_loss 19743.28228 | time  20.6s
[2018-08-08 14:01:59,498 INFO] | epoch   5 | train_loss -0.72 | val_loss 19632.34841 | time  20.1s
[2018-08-08 14:02:19,652 INFO] | epoch   6 | train_loss -0.74 | val_loss 19558.90639 | time  20.2s
[2018-08-08 14:02:38,862 INFO] | epoch   7 | train_loss -0.76 | val_loss 19511.70428 | time  19.2s
[2018-08-08 14:02:59,173 INFO] | epoch   8 | train_loss -0.77 | val_loss 19476.69551 | time  20.3s
[2018-08-08 14:02:59,829 INFO] test_loss: -0.77698
[2018-08-08 14:03:00,879 INFO] test_ppl: 19504.33167
[2018-08-09 01:29:11,669 INFO] Start training...


(explanation: loss is msq = (cosine - 0.25) ** 2, val_loss is ppl format)
[2018-08-09 01:29:11,670 INFO] Namespace(batch_size=20, bidirectional=False, bptt_len=10, device='cuda:0', dropout=0.0, epoch=8, every_n_epoch_save=40, log_file='log', lr=0.5, not_update_input_emb=False, num_layers=1, resources_dir='~/common_corpus/', rnn_type='GRU', save='nnlm.model', seed=0, tied=False, vector_type='glove.6B.100d')
[2018-08-09 01:29:22,971 INFO] train token: 2127402
[2018-08-09 01:29:22,971 INFO] test token: 250140
[2018-08-09 01:29:22,971 INFO] valid token: 221606
[2018-08-09 01:29:23,115 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-09 01:29:48,998 INFO] | epoch   1 | train_loss  0.00 | val_loss 23575.24944 | time  22.3s
[2018-08-09 01:30:09,208 INFO] | epoch   2 | train_loss  0.00 | val_loss 23507.86212 | time  20.2s
[2018-08-09 01:30:29,079 INFO] | epoch   3 | train_loss  0.00 | val_loss 23463.26118 | time  19.9s
[2018-08-09 01:30:50,385 INFO] | epoch   4 | train_loss  0.00 | val_loss 23431.39779 | time  21.3s
[2018-08-09 01:31:11,855 INFO] | epoch   5 | train_loss  0.00 | val_loss 23407.50529 | time  21.5s
[2018-08-09 01:31:33,719 INFO] | epoch   6 | train_loss  0.00 | val_loss 23386.82477 | time  21.9s
[2018-08-09 01:31:56,044 INFO] | epoch   7 | train_loss  0.00 | val_loss 23370.26840 | time  22.3s
[2018-08-09 01:32:18,014 INFO] | epoch   8 | train_loss  0.00 | val_loss 23357.03673 | time  22.0s
[2018-08-09 01:32:18,651 INFO] test_loss: -0.24454
[2018-08-09 01:32:19,681 INFO] test_ppl: 23346.67051


explanation: in a batch, the trained ppl and pre-train ppl. almost no change. How about in
full-softmax?
637 trained: 1.0160140320452098 pre 1.0160146146301565
638 trained: 1.015969982544083 pre 1.015970343985003
639 trained: 1.0159228751174658 pre 1.015923445213388
640 trained: 1.015931312084119 pre 1.0159319009741274
641 trained: 1.0158659004813881 pre 1.0158665579391202
642 trained: 1.0158602310178644 pre 1.0158606867462268
643 trained: 1.0158206523952187 pre 1.0158214614549959
644 trained: 1.0157842713699385 pre 1.0157849708394764

[2018-08-10 11:42:14,015 INFO] train token: 2127402
[2018-08-10 11:42:14,015 INFO] test token: 250140
[2018-08-10 11:42:14,015 INFO] valid token: 221606
[2018-08-10 11:42:14,155 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 11:49:21,253 INFO] train token: 2127402
[2018-08-10 11:49:21,253 INFO] test token: 250140
[2018-08-10 11:49:21,253 INFO] valid token: 221606
[2018-08-10 11:49:21,396 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 11:54:50,850 INFO] train token: 2127402
[2018-08-10 11:54:50,851 INFO] test token: 250140
[2018-08-10 11:54:50,851 INFO] valid token: 221606
[2018-08-10 11:54:50,989 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 11:55:56,481 INFO] train token: 2127402
[2018-08-10 11:55:56,482 INFO] test token: 250140
[2018-08-10 11:55:56,482 INFO] valid token: 221606
[2018-08-10 11:55:56,720 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 12:04:14,609 INFO] train token: 2127402
[2018-08-10 12:04:14,609 INFO] test token: 250140
[2018-08-10 12:04:14,609 INFO] valid token: 221606
[2018-08-10 12:04:14,752 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 12:04:52,064 INFO] train token: 2127402
[2018-08-10 12:04:52,064 INFO] test token: 250140
[2018-08-10 12:04:52,064 INFO] valid token: 221606
[2018-08-10 12:04:52,302 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 12:07:39,252 INFO] train token: 2127402
[2018-08-10 12:07:39,253 INFO] test token: 250140
[2018-08-10 12:07:39,253 INFO] valid token: 221606
[2018-08-10 12:07:39,480 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
[2018-08-10 12:08:45,669 INFO] train token: 2127402
[2018-08-10 12:08:45,669 INFO] test token: 250140
[2018-08-10 12:08:45,669 INFO] valid token: 221606
[2018-08-10 12:08:45,864 INFO] Loading vectors from /home/lr/yukun/common_corpus/glove.6B.100d.txt.pt
